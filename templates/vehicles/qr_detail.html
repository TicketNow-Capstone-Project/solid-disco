{% extends 'base.html' %}
{% load static %}
{% block title %}Vehicle QR | TicketNow{% endblock %}

{% block content %}
<div class="p-4">
    <div class="card shadow-sm border-0">
        <div class="card-body text-center">

            <h4 class="mb-1"><i class="bi bi-qr-code"></i> Vehicle QR Code</h4>
            <p class="text-muted small mb-4">{{ vehicle.vehicle_name }} â€” {{ vehicle.license_plate }}</p>

            <!-- Printable Area (ID Card Format) -->
            <div id="printArea" class="id-card">
                <div class="id-header text-center">
                    
                    <h6 class="mb-0 mt-1">TICKETNOW PASS</h6>
                    <small class="text-muted">Vehicle QR ID</small>
                </div>

                <div class="id-body text-center mt-1">
                    {% if vehicle.qr_code %}
                        <img src="{{ vehicle.qr_code.url }}" alt="QR Code" class="qr-image mb-1">
                    {% else %}
                        <div class="text-muted mb-2">No QR available.</div>
                    {% endif %}
                </div>

                <div class="id-info mt-1">
                    <strong>Driver:</strong> {{ vehicle.assigned_driver.first_name }} {{ vehicle.assigned_driver.last_name }}<br>
                    <strong>Plate No.:</strong> {{ vehicle.license_plate }}<br>
                    <strong>CR No.:</strong> {{ vehicle.cr_number }}<br>
                    <strong>OR No.:</strong> {{ vehicle.or_number }}<br>
                </div>

                <div class="id-footer text-center small text-muted mt-1">
                    {{ vehicle.date_registered|date:"M d, Y" }}
                </div>
            </div>


            <!-- Buttons -->
            <div class="mt-4">
                <button onclick="printQR()" class="btn btn-primary me-2">
                    <i class="bi bi-printer"></i> Print QR
                </button>
                <a href="{% url 'vehicles:registered_vehicles' %}" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Back to Registered Vehicles
                </a>
            </div>

        </div>
    </div>
</div>

<!-- Print Styles -->
<style>
@media print {
    body * {
        visibility: hidden !important;
    }
    #printArea, #printArea * {
        visibility: visible !important;
    }
    #printArea {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    .btn, nav, header, footer, .sidebar {
        display: none !important;
    }
}
</style>

<script>
function printQR() {
    window.print();
}
</script>
{% endblock %}
