{% extends 'base.html' %}
{% load static %}
{% block title %}Live Terminal Queue | RDFS{% endblock %}

{% block content %}
<style>
/* =====================================================
   RDFS – LIVE TERMINAL QUEUE (TV / KIOSK)
===================================================== */
.rdfs-tv-scope{
  --rdfs-blue:#112666;
  --rdfs-blue-dark:#0c1c4a;
  --rdfs-accent:#2563eb;
  --rdfs-soft:#e8f4fd;

  --rdfs-text:#0f172a;
  --rdfs-muted:#64748b;

  --gray-100:#f7fafc;
  --gray-200:#edf2f7;
  --gray-300:#e2e8f0;

  --success:#198754;
  --warning:#f59e0b;
  --danger:#dc3545;

  --shadow-sm:0 1px 3px rgba(0,0,0,.08);
  --shadow-md:0 8px 18px rgba(0,0,0,.12);

  font-family:"Segoe UI",system-ui,-apple-system,sans-serif;
  color:var(--rdfs-text);
}

/* CARD */
.rdfs-tv-card{
  background:#fff;
  border-radius:18px;
  box-shadow:var(--shadow-md);
  border:1px solid var(--gray-200);
}

/* HEADER */
.rdfs-tv-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:1rem;
  margin-bottom:1rem;
}

.rdfs-tv-title{
  font-weight:800;
  color:var(--rdfs-blue-dark);
}

.rdfs-tv-subtitle{
  font-size:.9rem;
  color:var(--rdfs-muted);
}

/* CLOCK */
.rdfs-tv-clock{
  font-size:1.3rem;
  font-weight:700;
  color:var(--rdfs-blue);
}

/* TABLE */
.rdfs-tv-table th{
  background:var(--rdfs-blue);
  color:#fff;
  font-weight:700;
  text-align:center;
  white-space:nowrap;
}

.rdfs-tv-table td{
  text-align:center;
  vertical-align:middle;
  font-size:1.05rem;
}

/* STATUS */
.rdfs-status-boarding{
  background:rgba(25,135,84,.15);
  color:var(--success);
  font-weight:700;
  border-radius:999px;
  padding:.35rem .8rem;
  display:inline-block;
}

.rdfs-status-soon{
  background:rgba(245,158,11,.18);
  color:var(--warning);
  font-weight:800;
  border-radius:999px;
  padding:.35rem .8rem;
  display:inline-block;
}

.rdfs-status-overdue{
  background:rgba(220,53,69,.15);
  color:var(--danger);
  font-weight:800;
  border-radius:999px;
  padding:.35rem .8rem;
  display:inline-block;
}
</style>

<div class="container-fluid mt-4 rdfs-tv-scope">
  <div class="rdfs-tv-card p-4">

    <!-- HEADER -->
    <div class="rdfs-tv-header">
      <div>
        <h2 class="rdfs-tv-title mb-1">
          <i class="bi bi-display-fill me-2 text-primary"></i>
          Live Terminal Queue
        </h2>
        <div class="rdfs-tv-subtitle">
          <i class="bi bi-arrow-repeat me-1"></i>
          Auto-refreshes every 10 seconds
        </div>
      </div>

      <div class="text-end">
        <div class="rdfs-tv-clock">
          <i class="bi bi-clock-history me-1"></i>
          {{ now|date:"h:i A" }}
        </div>
      </div>
    </div>

    <!-- TABLE -->
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle rdfs-tv-table mb-0">
        <thead>
          <tr>
            <th>#</th>
            <th><i class="bi bi-car-front-fill me-1"></i> Plate No.</th>
            <th><i class="bi bi-person-badge-fill me-1"></i> Driver</th>
            <th><i class="bi bi-box-arrow-in-right me-1"></i> Entry Time</th>
            <th><i class="bi bi-box-arrow-right me-1"></i> Departure</th>
          </tr>
        </thead>

        <tbody id="queue-body">
          {% if queue %}
            {% for q in queue %}
            <tr>
              <td>{{ forloop.counter }}</td>

              <td>
                <strong class="text-primary">
                  {{ q.plate }}
                </strong>
              </td>

              <td>{{ q.driver }}</td>

              <td>
                <i class="bi bi-clock me-1 text-muted"></i>
                {{ q.entry_time }}
              </td>

              <td>
                {% if q.departure_time|time < now|time %}
                  <span class="rdfs-status-overdue">
                    <i class="bi bi-exclamation-circle-fill me-1"></i>
                    Departing
                  </span>
                {% else %}
                  <span class="rdfs-status-boarding">
                    <i class="bi bi-check-circle-fill me-1"></i>
                    Boarding
                  </span>
                {% endif %}
                <div class="small text-muted mt-1">
                  {{ q.departure_time }}
                </div>
              </td>
            </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="5" class="text-center text-muted py-4">
                <i class="bi bi-info-circle-fill me-1"></i>
                No active vehicles currently in the terminal.
              </td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>

  </div>
</div>

<script>
/* AUTO-REFRESH – TV MODE */
setInterval(() => location.reload(), 10000);
</script>
{% endblock %}
