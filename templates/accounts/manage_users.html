{% extends 'base.html' %}
{% load static %}

{% block title %}Manage Accounts | RDFS{% endblock %}

{% block content %}
<style>
/* ===============================
   RDFS MANAGE ACCOUNTS (SCOPED)
================================ */
:root{
  --rdfs-blue:#112666;
  --rdfs-blue-dark:#180f92;
  --rdfs-blue-soft:#e8f4fd;

  --rdfs-bg:#f7fafc;
  --rdfs-card:#ffffff;

  --rdfs-text:#1c1b1b;
  --rdfs-muted:#64748b;

  --rdfs-border:#e2e8f0;
  --rdfs-radius:12px;

  --rdfs-shadow-sm:0 2px 6px rgba(0,0,0,.05);
  --rdfs-shadow-md:0 10px 22px rgba(0,0,0,.1);

  --rdfs-transition:.25s ease;
}

/* PAGE */
.rdfs-users-page{
  background:var(--rdfs-bg);
  min-height:100vh;
  padding:1.5rem 0;
}

/* HEADER */
.rdfs-users-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:1.6rem;
}

.rdfs-users-title{
  font-weight:800;
  color:var(--rdfs-blue-dark);
}

/* CARD */
.rdfs-users-card{
  background:var(--rdfs-card);
  border-radius:var(--rdfs-radius);
  box-shadow:var(--rdfs-shadow-md);
  border:1px solid var(--rdfs-border);
}

/* TABLE */
.rdfs-users-table th{
  background:var(--rdfs-blue-soft);
  color:var(--rdfs-blue-dark);
  font-size:.8rem;
  text-transform:uppercase;
  letter-spacing:.6px;
  border-bottom:2px solid var(--rdfs-blue);
}

.rdfs-users-table td{
  vertical-align:middle;
}

.rdfs-users-table tbody tr:hover{
  background:rgba(17,38,102,.04);
}

/* ROLE BADGES */
.rdfs-role-admin{
  background:#dc2626;
}

.rdfs-role-staff{
  background:var(--rdfs-blue);
}

/* ACTION BUTTONS */
.rdfs-action-btn{
  font-size:.8rem;
  font-weight:600;
  border-radius:8px;
}

/* CREATE BUTTON */
.rdfs-create-btn{
  background:linear-gradient(
    135deg,
    var(--rdfs-blue),
    var(--rdfs-blue-dark)
  );
  border:none;
  font-weight:700;
}

.rdfs-create-btn:hover{
  box-shadow:0 8px 18px rgba(17,38,102,.35);
  transform:translateY(-1px);
}
</style>

<div class="container rdfs-users-page">

  <!-- HEADER -->
  <div class="rdfs-users-header">
    <div>
      <h3 class="rdfs-users-title">
        <i class="bi bi-person-badge-fill me-2"></i>
        Manage Accounts
      </h3>
      <p class="text-muted mb-0">
        View, create, and manage admin and staff accounts.
      </p>
    </div>

    <a href="{% url 'accounts:create_user' %}"
       class="btn rdfs-create-btn text-white">
      <i class="bi bi-person-plus-fill me-1"></i>
      Create Account
    </a>
  </div>

  <!-- TABLE CARD -->
  <div class="rdfs-users-card p-3">

    <div class="table-responsive">
      <table class="table rdfs-users-table align-middle mb-0">
        <thead>
          <tr>
            <th>Username</th>
            <th>Email</th>
            <th>Role</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>

        <tbody>
          {% for user in users %}
          <tr>
            <td><strong>{{ user.username }}</strong></td>
            <td>{{ user.email }}</td>

            <td>
              {% if user.role == 'admin' %}
                <span class="badge rdfs-role-admin">
                  <i class="bi bi-shield-lock-fill me-1"></i>
                  Admin
                </span>
              {% elif user.role == 'staff_admin' %}
                <span class="badge rdfs-role-staff">
                  <i class="bi bi-person-badge-fill me-1"></i>
                  Staff Admin
                </span>
              {% else %}
                <span class="badge bg-secondary">Unknown</span>
              {% endif %}
            </td>

            <td class="text-center">
              <a href="{% url 'accounts:edit_user' user.id %}"
                 class="btn btn-warning btn-sm rdfs-action-btn me-1">
                <i class="bi bi-pencil-fill"></i>
                Edit
              </a>

              <a href="{% url 'accounts:delete_user' user.id %}"
                 class="btn btn-danger btn-sm rdfs-action-btn">
                <i class="bi bi-trash-fill"></i>
                Delete
              </a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted py-4">
              <i class="bi bi-info-circle me-1"></i>
              No users found.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>

  <!-- FLASH MESSAGES -->
  {% if messages %}
    <div class="mt-3">
      {% for message in messages %}
        <div class="alert alert-success py-2 mb-2">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

</div>
{% endblock %}
