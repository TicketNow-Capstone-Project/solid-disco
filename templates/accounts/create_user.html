{% extends "base.html" %}
{% load static %}

{% block title %}Create New Account | RDFS{% endblock %}

{% block content %}
<style>
/* ===============================
   RDFS CREATE ACCOUNT (SCOPED)
================================ */
:root{
  --rdfs-blue:#112666;
  --rdfs-blue-dark:#180f92;
  --rdfs-blue-soft:#e8f4fd;

  --rdfs-text:#1c1b1b;
  --rdfs-muted:#64748b;

  --rdfs-bg:#f7fafc;
  --rdfs-card:#ffffff;

  --rdfs-radius:14px;
  --rdfs-shadow:0 12px 28px rgba(0,0,0,.12);
  --rdfs-transition:.25s ease;
}

/* PAGE */
.rdfs-acct-create{
  min-height:80vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:var(--rdfs-bg);
}

/* CARD */
.rdfs-acct-create__card{
  position:relative; /* for top-right cancel */
  max-width:520px;
  width:100%;
  background:var(--rdfs-card);
  padding:2.25rem 2rem;
  border-radius:var(--rdfs-radius);
  box-shadow:var(--rdfs-shadow);
  border:1px solid #e2e8f0;
}

/* TOP RIGHT CANCEL */
.rdfs-acct-create__cancel{
  position:absolute;
  top:1rem;
  right:1rem;
  border-radius:999px;
  font-weight:600;
}

/* TITLE */
.rdfs-acct-create__title{
  font-weight:800;
  color:var(--rdfs-blue-dark);
  margin-bottom:.35rem;
}

/* NOTE */
.rdfs-acct-create__note{
  font-size:.9rem;
  color:var(--rdfs-muted);
  margin-bottom:1.6rem;
}

/* FORM FIELD */
.rdfs-acct-create__field label{
  font-weight:600;
  color:var(--rdfs-text);
}

.rdfs-acct-create__field input,
.rdfs-acct-create__field select{
  border-radius:10px;
}

/* ERROR */
.rdfs-acct-create__error{
  font-size:.8rem;
  color:#dc3545;
  margin-top:.25rem;
}

/* SUBMIT BUTTON */
.rdfs-acct-create__submit{
  background:linear-gradient(
    135deg,
    var(--rdfs-blue),
    var(--rdfs-blue-dark)
  );
  border:none;
  color:#fff;
  font-weight:700;
  transition:var(--rdfs-transition);
}

.rdfs-acct-create__submit:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 18px rgba(17,38,102,.35);
}
</style>

<div class="container rdfs-acct-create">

  <div class="rdfs-acct-create__card">

    <!-- TOP RIGHT CANCEL -->
    <a href="{% url 'accounts:manage_users' %}"
       class="btn btn-outline-secondary btn-sm rdfs-acct-create__cancel">
      <i class="bi bi-x-circle-fill me-1"></i>
      Cancel
    </a>

    <!-- TITLE -->
    <h3 class="rdfs-acct-create__title text-center">
      Create New Account
    </h3>

    {% if user.role == 'admin' %}
      <p class="rdfs-acct-create__note text-center">
        As an Admin, you can create both Admin and Staff Admin accounts.
      </p>
    {% else %}
      <p class="rdfs-acct-create__note text-center">
        As a Staff Admin, you can only create Staff Admin accounts.
      </p>
    {% endif %}

    <!-- ALERTS -->
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
          {{ message }}
          <button class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    {% endif %}

    <form method="POST" novalidate>
      {% csrf_token %}

      <!-- USERNAME -->
      <div class="mb-3 rdfs-acct-create__field">
        <label class="form-label">Username</label>
        {{ form.username }}
        {% if form.username.errors %}
          <div class="rdfs-acct-create__error">
            {{ form.username.errors.0 }}
          </div>
        {% endif %}
      </div>

      <!-- EMAIL -->
      <div class="mb-3 rdfs-acct-create__field">
        <label class="form-label">Email Address</label>
        {{ form.email }}
        {% if form.email.errors %}
          <div class="rdfs-acct-create__error">
            {{ form.email.errors.0 }}
          </div>
        {% endif %}
      </div>

      <!-- ROLE -->
      <div class="mb-3 rdfs-acct-create__field">
        <label class="form-label">Account Role</label>
        {{ form.role }}

        {% if user.role == 'admin' %}
          <small class="text-muted d-block mt-1">
            • Choose <strong>Admin</strong> or <strong>Staff Admin</strong>.
          </small>
        {% else %}
          <small class="text-muted d-block mt-1">
            • Only Staff Admin accounts can be created.
          </small>
        {% endif %}

        {% if form.role.errors %}
          <div class="rdfs-acct-create__error">
            {{ form.role.errors.0 }}
          </div>
        {% endif %}
      </div>

      <!-- PASSWORD -->
      <div class="mb-3 rdfs-acct-create__field">
        <label class="form-label">Password</label>
        {{ form.password1 }}
        {% if form.password1.errors %}
          <div class="rdfs-acct-create__error">
            {{ form.password1.errors.0 }}
          </div>
        {% endif %}
      </div>

      <!-- CONFIRM PASSWORD -->
      <div class="mb-3 rdfs-acct-create__field">
        <label class="form-label">Confirm Password</label>
        {{ form.password2 }}
        {% if form.password2.errors %}
          <div class="rdfs-acct-create__error">
            {{ form.password2.errors.0 }}
          </div>
        {% endif %}
      </div>

      <!-- SUBMIT -->
      <div class="d-grid mt-4">
        <button type="submit"
                class="btn btn-lg rounded-pill rdfs-acct-create__submit">
          <i class="bi bi-person-plus-fill me-2"></i>
          Create Account
        </button>
      </div>

    </form>

  </div>

</div>
{% endblock %}
